<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Real-time Currency Converter</title>
    <style>
        /* ... (previous CSS remains unchanged) ... */
    </style>
</head>
<body>
    <div class="converter">
        <div class="display" id="display">0</div>
        <div class="currency-select">
            <select id="fromCurrency">
                <!-- Options will be dynamically populated -->
            </select>
            <select id="toCurrency">
                <!-- Options will be dynamically populated -->
            </select>
        </div>
        <div class="buttons">
            <!-- ... (button layout remains unchanged) ... -->
        </div>
    </div>

    <script>
        let display = document.getElementById('display');
        let currentValue = '0';
        let exchangeRates = {};
        const API_KEY = 'dc42fde89e2a2e8c748df2ba3c403581'; // Replace with your actual API key

        // Fetch exchange rates from the API
        async function fetchExchangeRates() {
            try {
                const response = await fetch(`http://api.exchangeratesapi.io/v1/latest?access_key=${API_KEY}`);
                const data = await response.json();
                exchangeRates = data.rates;
                exchangeRates[data.base] = 1; // Add base currency (usually EUR) to the rates
                populateCurrencyDropdowns();
            } catch (error) {
                console.error('Error fetching exchange rates:', error);
                display.textContent = 'Error fetching rates';
            }
        }

        // Populate currency dropdowns
        function populateCurrencyDropdowns() {
            const fromCurrency = document.getElementById('fromCurrency');
            const toCurrency = document.getElementById('toCurrency');
            
            for (let currency in exchangeRates) {
                let option = new Option(currency, currency);
                fromCurrency.add(option);
                
                option = new Option(currency, currency);
                toCurrency.add(option);
            }

            // Set default values
            fromCurrency.value = 'USD';
            toCurrency.value = 'EUR';
        }

        // ... (previous functions: updateDisplay, appendNumber, appendDecimal, clearDisplay, backspace remain unchanged) ...

        async function convert() {
            const fromCurrency = document.getElementById('fromCurrency').value;
            const toCurrency = document.getElementById('toCurrency').value;
            const amount = parseFloat(currentValue);

            if (isNaN(amount)) {
                display.textContent = 'Error';
                return;
            }

            try {
                // Convert to base currency (EUR) first, then to target currency
                const amountInEUR = amount / exchangeRates[fromCurrency];
                const result = (amountInEUR * exchangeRates[toCurrency]).toFixed(2);
                display.textContent = `${result} ${toCurrency}`;
            } catch (error) {
                console.error('Error during conversion:', error);
                display.textContent = 'Conversion error';
            }
        }

        // Initialize
        fetchExchangeRates();
        updateDisplay();
    </script>
</body>
</html>